NX_input = '''\
----------------------------------------
Device ID:NSNE-CORE-2(FDO2233207B)
System Name: NSNE-CORE-2

Interface address(es): 1
    IPv4 Address: 192.168.1.2
Platform: N9K-C93180YC-EX, Capabilities: Router Switch Supports-STP-Dispute
Interface: mgmt0, Port ID (outgoing port): mgmt0
Holdtime: 162 sec

Version:
Cisco Nexus Operating System (NX-OS) Software, Version 10.2(4)

Advertisement Version: 2
Duplex: full

MTU: 1500
Physical Location: `
Mgmt address(es):
    IPv4 Address: 192.168.1.2
Local Interface MAC: 00:b7:71:74:3e:60
Remote Interface MAC: 00:b7:71:74:17:f0
DC_UUID: FDO2233207B
----------------------------------------
Device ID:NSNE-RM1-RMOffice.bar.nucorsteel.local

Interface address(es): 1
    IPv4 Address: 10.30.158.61
Platform: cisco C9200L-24P-4X, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/1, Port ID (outgoing port): TenGigabitEthernet1/1/4
Holdtime: 125 sec

Version:
Cisco IOS Software [Bengaluru], Catalyst L3 Switch Software (CAT9K_LITE_IOSXE), Version 17.6.3, RELEASE SOFTWARE (fc4)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Wed 30-Mar-22 21:23 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.61
Local Interface MAC: 00:b7:71:74:3e:68
Remote Interface MAC: 4c:71:0d:e0:56:1c
DC_UUID:  
----------------------------------------
Device ID:NSNE-FrontOffice-1.bar.nucorsteel.local

Interface address(es): 1
    IPv4 Address: 10.30.158.15
Platform: cisco C9200L-48P-4X, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/2, Port ID (outgoing port): GigabitEthernet1/0/48
Holdtime: 153 sec

Version:
Cisco IOS Software [Bengaluru], Catalyst L3 Switch Software (CAT9K_LITE_IOSXE), Version 17.6.4, RELEASE SOFTWARE (fc1)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Sun 14-Aug-22 07:06 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.15
Local Interface MAC: 00:b7:71:74:3e:69
Remote Interface MAC: a0:b4:39:3d:f6:30
DC_UUID:  
----------------------------------------
Device ID:NSNE-Shipping-Coilload.bar.nucorsteel.lo

Interface address(es): 1
    IPv4 Address: 10.30.158.85
Platform: cisco WS-C2960CX-8PC-L, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/3, Port ID (outgoing port): GigabitEthernet0/12
Holdtime: 136 sec

Version:
Cisco IOS Software, C2960CX Software (C2960CX-UNIVERSALK9-M), Version 15.2(7)E7, RELEASE SOFTWARE (fc10)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Thu 22-Sep-22 08:53 by mcpre

Advertisement Version: 1
Local Interface MAC: 00:b7:71:74:3e:6a
Remote Interface MAC: f4:bd:9e:c6:73:0c
DC_UUID:  
----------------------------------------
Device ID:NSNE-RM1-Rollshop.bar.nucorsteel.local

Interface address(es): 1
    IPv4 Address: 10.30.158.70
Platform: cisco WS-C3560CX-12PC-S, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/4, Port ID (outgoing port): GigabitEthernet0/16
Holdtime: 127 sec

Version:
Cisco IOS Software, C3560CX Software (C3560CX-UNIVERSALK9-M), Version 15.2(7)E7, RELEASE SOFTWARE (fc10)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Thu 22-Sep-22 09:00 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.70
Local Interface MAC: 00:b7:71:74:3e:6b
Remote Interface MAC: c4:b3:6a:9f:c1:90
DC_UUID:  
----------------------------------------
Device ID:NSNE-Shipping-Column58.bar.nucorsteel.lo

Interface address(es): 1
    IPv4 Address: 10.30.158.84
Platform: cisco WS-C2960CX-8PC-L, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/6, Port ID (outgoing port): GigabitEthernet0/11
Holdtime: 146 sec

Version:
Cisco IOS Software, C2960CX Software (C2960CX-UNIVERSALK9-M), Version 15.2(7)E7, RELEASE SOFTWARE (fc10)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Thu 22-Sep-22 08:53 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.84
Local Interface MAC: 00:b7:71:74:3e:6d
Remote Interface MAC: 3c:41:0e:84:05:0b
DC_UUID:  
----------------------------------------
Device ID:NSNE-TruckScale-Old.bar.nucorsteel.local

Interface address(es): 1
    IPv4 Address: 10.30.158.24
Platform: cisco C9200L-24P-4X, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/7, Port ID (outgoing port): TenGigabitEthernet1/1/1
Holdtime: 132 sec

Version:
Cisco IOS Software [Bengaluru], Catalyst L3 Switch Software (CAT9K_LITE_IOSXE), Version 17.6.4, RELEASE SOFTWARE (fc1)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Sun 14-Aug-22 07:06 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.24
Local Interface MAC: 00:b7:71:74:3e:6e
Remote Interface MAC: 7c:21:0e:9f:bd:19
DC_UUID:  
----------------------------------------
Device ID:NSNE-RM1-Intermediate.bar.nucorsteel.local

Interface address(es): 1
    IPv4 Address: 10.30.158.75
Platform: cisco C9300-24P, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/8, Port ID (outgoing port): TenGigabitEthernet1/1/8
Holdtime: 154 sec

Version:
Cisco IOS Software [Bengaluru], Catalyst L3 Switch Software (CAT9K_IOSXE), Version 17.6.4, RELEASE SOFTWARE (fc1)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Sun 14-Aug-22 08:58 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.75
Local Interface MAC: 00:b7:71:74:3e:6f
Remote Interface MAC: 10:b3:c6:59:0c:24
DC_UUID:  
----------------------------------------
Device ID:NSNE-RM2-PCR4

Interface address(es): 1
    IPv4 Address: 10.30.158.101
Platform: cisco C9300-24P, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/9, Port ID (outgoing port): TenGigabitEthernet1/1/7
Holdtime: 144 sec

Version:
Cisco IOS Software [Bengaluru], Catalyst L3 Switch Software (CAT9K_IOSXE), Version 17.6.4, RELEASE SOFTWARE (fc1)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Sun 14-Aug-22 08:58 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.101
Local Interface MAC: 00:b7:71:74:3e:70
Remote Interface MAC: 6c:41:0e:d8:2c:a3
DC_UUID:  
----------------------------------------
Device ID:NSNE-FrontOffice-Sales.bar.nucorsteel.local

Interface address(es): 1
    IPv4 Address: 10.30.158.12
Platform: cisco C9200L-24P-4X, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/11, Port ID (outgoing port): TenGigabitEthernet2/1/1
Holdtime: 175 sec

Version:
Cisco IOS Software [Bengaluru], Catalyst L3 Switch Software (CAT9K_LITE_IOSXE), Version 17.6.4, RELEASE SOFTWARE (fc1)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Sun 14-Aug-22 07:06 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.12
Local Interface MAC: 00:b7:71:74:3e:72
Remote Interface MAC: a0:b4:39:3d:f8:31
DC_UUID:  
----------------------------------------
Device ID:NSNE-Shipping-CBay-1.bar.nucorsteel.loca

Interface address(es): 1
    IPv4 Address: 10.30.158.81
Platform: cisco WS-C2960CX-8PC-L, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/12, Port ID (outgoing port): GigabitEthernet0/11
Holdtime: 157 sec

Version:
Cisco IOS Software, C2960CX Software (C2960CX-UNIVERSALK9-M), Version 15.2(7)E7, RELEASE SOFTWARE (fc10)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Thu 22-Sep-22 08:53 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.81
Local Interface MAC: 00:b7:71:74:3e:73
Remote Interface MAC: a4:b2:39:b5:b7:0b
DC_UUID:  
----------------------------------------
Device ID:NSNE-QAL-2.bar.nucorsteel.local

Interface address(es): 1
    IPv4 Address: 10.30.158.93
Platform: cisco C9200L-24P-4X, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/13, Port ID (outgoing port): TenGigabitEthernet1/1/4
Holdtime: 140 sec

Version:
Cisco IOS Software [Bengaluru], Catalyst L3 Switch Software (CAT9K_LITE_IOSXE), Version 17.6.4, RELEASE SOFTWARE (fc1)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Sun 14-Aug-22 07:06 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.93
Local Interface MAC: 00:b7:71:74:3e:74
Remote Interface MAC: a0:b4:39:3d:e8:9c
DC_UUID:  
----------------------------------------
Device ID:NSNE-Shipping-CBay-2.bar.nucorsteel.loca

Interface address(es): 1
    IPv4 Address: 10.30.158.83
Platform: cisco WS-C2960CX-8PC-L, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/14, Port ID (outgoing port): GigabitEthernet0/11
Holdtime: 166 sec

Version:
Cisco IOS Software, C2960CX Software (C2960CX-UNIVERSALK9-M), Version 15.2(7)E7, RELEASE SOFTWARE (fc10)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Thu 22-Sep-22 08:53 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.83
Local Interface MAC: 00:b7:71:74:3e:75
Remote Interface MAC: a4:b2:39:a7:91:0b
DC_UUID:  
----------------------------------------
Device ID:NSNE-Cafe-Basement

Interface address(es): 1
    IPv4 Address: 10.30.158.10
Platform: cisco C9200L-48P-4X, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/15, Port ID (outgoing port): TenGigabitEthernet1/1/3
Holdtime: 161 sec

Version:
Cisco IOS Software [Bengaluru], Catalyst L3 Switch Software (CAT9K_LITE_IOSXE), Version 17.6.4, RELEASE SOFTWARE (fc1)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Sun 14-Aug-22 07:06 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.10
Local Interface MAC: 00:b7:71:74:3e:76
Remote Interface MAC: a0:b4:39:b9:8b:33
DC_UUID:  
----------------------------------------
Device ID:NSNE-QA-Offices.bar.nucorsteel.local

Interface address(es): 1
    IPv4 Address: 10.30.158.14
Platform: cisco C9200L-48P-4X, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/16, Port ID (outgoing port): TenGigabitEthernet1/1/1
Holdtime: 149 sec

Version:
Cisco IOS Software [Bengaluru], Catalyst L3 Switch Software (CAT9K_LITE_IOSXE), Version 17.6.4, RELEASE SOFTWARE (fc1)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Sun 14-Aug-22 07:06 by mcpre

Advertisement Version: 1
Local Interface MAC: 00:b7:71:74:3e:77
Remote Interface MAC: 7c:21:0e:8b:20:31
DC_UUID:  
----------------------------------------
Device ID:NSNE-MS-Caster-CR.bar.nucorsteel.local

Interface address(es): 1
    IPv4 Address: 10.30.158.33
Platform: cisco C9300-48P, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/17, Port ID (outgoing port): TenGigabitEthernet1/1/7
Holdtime: 174 sec

Version:
Cisco IOS Software [Bengaluru], Catalyst L3 Switch Software (CAT9K_IOSXE), Version 17.6.3, RELEASE SOFTWARE (fc4)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Wed 30-Mar-22 23:09 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.33
Local Interface MAC: 00:b7:71:74:3e:78
Remote Interface MAC: 6c:71:0d:93:82:bb
DC_UUID:  
----------------------------------------
Device ID:NSNE-MS-LMF-CR.bar.nucorsteel.local

Interface address(es): 1
    IPv4 Address: 10.30.158.39
Platform: cisco C9300-24P, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/18, Port ID (outgoing port): TenGigabitEthernet1/1/8
Holdtime: 134 sec

Version:
Cisco IOS Software [Bengaluru], Catalyst L3 Switch Software (CAT9K_IOSXE), Version 17.6.4, RELEASE SOFTWARE (fc1)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Sun 14-Aug-22 08:58 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.39
Local Interface MAC: 00:b7:71:74:3e:79
Remote Interface MAC: 4c:e1:75:7a:fb:24
DC_UUID:  
----------------------------------------
Device ID:NSNE-MS-EAF-CR

Interface address(es): 1
    IPv4 Address: 10.30.158.36
Platform: cisco C9300-24P, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/19, Port ID (outgoing port): TenGigabitEthernet1/1/7
Holdtime: 157 sec

Version:
Cisco IOS Software [Bengaluru], Catalyst L3 Switch Software (CAT9K_IOSXE), Version 17.6.3, RELEASE SOFTWARE (fc4)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Wed 30-Mar-22 23:09 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.36
Local Interface MAC: 00:b7:71:74:3e:7a
Remote Interface MAC: 10:b3:c6:84:98:23
DC_UUID:  
----------------------------------------
Device ID:NSNE-RM1-CBCR.bar.nucorsteel.local

Interface address(es): 1
    IPv4 Address: 10.30.158.63
Platform: cisco C9200L-24P-4X, Capabilities: Switch IGMP Filtering 
Interface: Ethernet1/24, Port ID (outgoing port): TenGigabitEthernet1/1/3
Holdtime: 167 sec

Version:
Cisco IOS Software [Bengaluru], Catalyst L3 Switch Software (CAT9K_LITE_IOSXE), Version 17.6.4, RELEASE SOFTWARE (fc1)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Sun 14-Aug-22 07:06 by mcpre

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Mgmt address(es):
    IPv4 Address: 10.30.158.63
Local Interface MAC: 00:b7:71:74:3e:7f
Remote Interface MAC: 7c:21:0e:6b:f0:9b
DC_UUID:  
----------------------------------------
Device ID:NSNE-9800-WLC-01.bar.nucorsteel.local

Interface address(es): 1
    IPv4 Address: 10.30.176.5
Platform: cisco C9800-L-F-K9, Capabilities: Router IGMP Filtering 
Interface: Ethernet1/37, Port ID (outgoing port): TenGigabitEthernet0/1/0
Holdtime: 167 sec

Version:
Cisco IOS Software [Bengaluru], C9800 Software (C9800_IOSXE-K9), Version 17.6.4, RELEASE SOFTWARE (fc1)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2022 by Cisco Systems, Inc.
Compiled Sun 14-Aug-22 08:54 by mcpre

Advertisement Version: 2
Mgmt address(es):
    IPv4 Address: 10.30.176.5
Local Interface MAC: 00:b7:71:74:3e:8c
Remote Interface MAC: 8c:1e:80:6a:53:70
DC_UUID:  
----------------------------------------
Device ID:NSNE_WLC

Interface address(es): 2
    IPv4 Address: 10.30.215.207
    IPv6 Address: fe80::6e20:56ff:fe65:3e2f
Platform: AIR-CT5508-K9, Capabilities: Host
Interface: Ethernet1/46, Port ID (outgoing port): GigabitEthernet0/0/1
Holdtime: 162 sec

Version:
Manufacturer's Name: Cisco Systems Inc.  Product Name: Cisco Controller  Product Version: 8.2.151.0  RTOS Version: Erro  Bootloader Version: 1.0.20  Build Type: DATA + WPS

Advertisement Version: 2
Duplex: full
Local Interface MAC: 00:b7:71:74:3e:95
Remote Interface MAC: 6c:20:56:65:3e:24
DC_UUID:  
----------------------------------------
Device ID:NSNE-UCS-FI-A(FDO22271ZJM)
System Name: NSNE-UCS-FI-A

Interface address(es): 1
    IPv4 Address: 10.30.150.21
Platform: UCS-FI-6332, Capabilities: Router Switch IGMP Filtering Supports-STP-Dispute
Interface: Ethernet1/49, Port ID (outgoing port): Ethernet1/25
Holdtime: 163 sec

Version:
Cisco Nexus Operating System (NX-OS) Software, Version 5.0(3)N2(4.13g)

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Physical Location: snmplocation
Mgmt address(es):
    IPv4 Address: 10.30.150.21
Local Interface MAC: 00:b7:71:74:3e:98
Remote Interface MAC: bc:26:c7:7d:4b:b8
DC_UUID:  
----------------------------------------
Device ID:NSNE-UCS-FI-B(FDO22271ZDT)
System Name: NSNE-UCS-FI-B

Interface address(es): 1
    IPv4 Address: 10.30.150.22
Platform: UCS-FI-6332, Capabilities: Router Switch IGMP Filtering Supports-STP-Dispute
Interface: Ethernet1/50, Port ID (outgoing port): Ethernet1/25
Holdtime: 157 sec

Version:
Cisco Nexus Operating System (NX-OS) Software, Version 5.0(3)N2(4.13g)

Advertisement Version: 2

Native VLAN: 1
Duplex: full
Physical Location: snmplocation
Mgmt address(es):
    IPv4 Address: 10.30.150.22
Local Interface MAC: 00:b7:71:74:3e:9c
Remote Interface MAC: bc:26:c7:03:dc:ac
DC_UUID:  
----------------------------------------
Device ID:NSNE-CORE-2(FDO2233207B)
System Name: NSNE-CORE-2

Interface address(es): 1
    IPv4 Address: 10.30.100.252
Platform: N9K-C93180YC-EX, Capabilities: Router Switch Supports-STP-Dispute
Interface: Ethernet1/53, Port ID (outgoing port): Ethernet1/53
Holdtime: 142 sec

Version:
Cisco Nexus Operating System (NX-OS) Software, Version 10.2(4)

Advertisement Version: 2

Native VLAN: 1
Duplex: full

MTU: 1500
Physical Location: `
Mgmt address(es):
    IPv4 Address: 192.168.1.2
Local Interface MAC: 00:b7:71:74:3e:a8
Remote Interface MAC: 00:b7:71:74:17:f7
DC_UUID: FDO2233207B
----------------------------------------
Device ID:NSNE-CORE-2(FDO2233207B)
System Name: NSNE-CORE-2

Interface address(es): 1
    IPv4 Address: 10.30.100.252
Platform: N9K-C93180YC-EX, Capabilities: Router Switch Supports-STP-Dispute
Interface: Ethernet1/54, Port ID (outgoing port): Ethernet1/54
Holdtime: 162 sec

Version:
Cisco Nexus Operating System (NX-OS) Software, Version 10.2(4)

Advertisement Version: 2

Native VLAN: 1
Duplex: full

MTU: 1500
Physical Location: `
Mgmt address(es):
    IPv4 Address: 192.168.1.2
Local Interface MAC: 00:b7:71:74:3e:ac
Remote Interface MAC: 00:b7:71:74:17:f7
DC_UUID: FDO2233207B
'''

IOS_input = '''\
-------------------------
Device ID: AP-ITOffice
Entry address(es): 
  IP address: 10.20.128.113
  IPv6 address: FE80::1008:FBFF:56C1:F24E  (link-local)
Platform: cisco C9120AXI-B,  Capabilities: Router Trans-Bridge 
Interface: TenGigabitEthernet1/0/37,  Port ID (outgoing port): GigabitEthernet0
Holdtime : 166 sec

Version :
Cisco AP Software, ap1g7-k9w8 Version: 17.11.0.155
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 2014-2015 by Cisco Systems, Inc.

advertisement version: 2
Duplex: full
Power drawn: 23.200 Watts
Power request id: 39244, Power management id: 2
Power request levels are:23200 15400 0 0 0 
Management address(es): 
  IP address: 10.20.128.113

-------------------------
Device ID: KNK-ADM-ITConference-Aux.bar.nucorsteel.
Entry address(es): 
  IP address: 10.20.128.75
Platform: cisco WS-C3560CX-12PD-S,  Capabilities: Switch IGMP 
Interface: TwoGigabitEthernet1/0/29,  Port ID (outgoing port): GigabitEthernet1/0/14
Holdtime : 148 sec

Version :
Cisco IOS Software, C3560CX Software (C3560CX-UNIVERSALK9-M), Version 15.2(7)E5, RELEASE SOFTWARE (fc3)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2021 by Cisco Systems, Inc.
Compiled Mon 13-Sep-21 10:08 by mcpre

advertisement version: 2
VTP Management Domain: 'NSKNK'
Native VLAN: 1281
Duplex: full
Management address(es): 
  IP address: 10.20.128.75

-------------------------
Device ID: AP-Test-Client
Entry address(es): 
  IPv6 address: FE80::E52A:2BB:7B76:E8AC  (link-local)
Platform: cisco C9124AXE-B,  Capabilities: Router Trans-Bridge 
Interface: TwoGigabitEthernet1/0/11,  Port ID (outgoing port): GigabitEthernet0
Holdtime : 145 sec

Version :
Cisco AP Software, ap1g6a-k9w8 Version: 17.11.0.155
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 2014-2015 by Cisco Systems, Inc.

advertisement version: 2
Power drawn: 60.000 Watts
Power request id: 22860, Power management id: 3
Power request levels are:60000 30000 15400 0 0 
Management address(es): 
Spare Pair PoE: Yes, Spare Pair Detection Required: No
Spare Pair PD Config: Enable, Spare Pair PSE Operational: Yes

-------------------------
Device ID: SEPF87B20897A57
Entry address(es): 
  IP address: 10.20.129.165
Platform: Cisco IP Phone 8861,  Capabilities: Host Phone Two-port Mac Relay 
Interface: TenGigabitEthernet1/0/44,  Port ID (outgoing port): Port 1
Holdtime : 167 sec
Second Port Status: Down

Version :
sip88xx.14-1-1-0001-125.loads

advertisement version: 2
Duplex: full
Power drawn: 16.454 Watts
Power request id: 22400, Power management id: 2
Power request levels are:16454 0 0 0 0 

-------------------------
Device ID: SEP2C3124C9C4C1
Entry address(es): 
  IP address: 10.20.129.155
Platform: Cisco IP Phone 8861,  Capabilities: Host Phone Two-port Mac Relay 
Interface: TwoGigabitEthernet1/0/27,  Port ID (outgoing port): Port 1
Holdtime : 139 sec
Second Port Status: Up

Version :
sip88xx.14-1-1-0001-125.loads

advertisement version: 2
Duplex: full
Power drawn: 12.937 Watts
Power request id: 49607, Power management id: 4
Power request levels are:12937 0 0 0 0 

-------------------------
Device ID: SEPF87B20899812
Entry address(es): 
  IP address: 10.45.154.22
Platform: Cisco IP Phone 8861,  Capabilities: Host Phone Two-port Mac Relay 
Interface: TwoGigabitEthernet1/0/26,  Port ID (outgoing port): Port 1
Holdtime : 146 sec
Second Port Status: Down

Version :
sip88xx.14-2-1-0001-14.loads

advertisement version: 2
Duplex: full
Power drawn: 16.454 Watts
Power request id: 4766, Power management id: 6
Power request levels are:16454 0 0 0 0 

-------------------------
Device ID: SEP2C3124C9CB24
Entry address(es): 
  IP address: 10.20.129.154
Platform: Cisco IP Phone 8861,  Capabilities: Host Phone Two-port Mac Relay 
Interface: TwoGigabitEthernet1/0/17,  Port ID (outgoing port): Port 1
Holdtime : 174 sec
Second Port Status: Down

Version :
sip88xx.14-1-1-0001-125.loads

advertisement version: 2
Duplex: full
Power drawn: 12.937 Watts
Power request id: 9421, Power management id: 3
Power request levels are:12937 0 0 0 0 

-------------------------
Device ID: SEP00B1E3BA4092
Entry address(es): 
  IP address: 10.20.129.153
Platform: Cisco IP Phone 8861,  Capabilities: Host Phone Two-port Mac Relay 
Interface: TwoGigabitEthernet1/0/10,  Port ID (outgoing port): Port 1
Holdtime : 139 sec
Second Port Status: Down

Version :
sip88xx.14-1-1-0001-125.loads

advertisement version: 2
Duplex: full
Power drawn: 12.937 Watts
Power request id: 37442, Power management id: 3
Power request levels are:12937 0 0 0 0 

-------------------------
Device ID: ITAdminDistribution.bar.nucorsteel.local
Entry address(es): 
  IP address: 10.20.60.254
Platform: cisco C9300X-24Y,  Capabilities: Router Switch IGMP 
Interface: TenGigabitEthernet1/1/7,  Port ID (outgoing port): TwentyFiveGigE1/0/1
Holdtime : 160 sec

Version :
Cisco IOS Software [Dublin], Catalyst L3 Switch Software (CAT9K_IOSXE), Version 17.11.1, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2023 by Cisco Systems, Inc.
Compiled Fri 24-Mar-23 06:28 by mcpre

advertisement version: 2
VTP Management Domain: 'NSKNK'
Native VLAN: 1281
Duplex: full
Management address(es): 
  IP address: 10.20.60.254

-------------------------
Device ID: ITAdminDistribution.bar.nucorsteel.local
Entry address(es): 
  IP address: 10.20.60.254
Platform: cisco C9300X-24Y,  Capabilities: Router Switch IGMP 
Interface: TenGigabitEthernet1/1/8,  Port ID (outgoing port): TwentyFiveGigE2/0/1
Holdtime : 128 sec

Version :
Cisco IOS Software [Dublin], Catalyst L3 Switch Software (CAT9K_IOSXE), Version 17.11.1, RELEASE SOFTWARE (fc2)
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 1986-2023 by Cisco Systems, Inc.
Compiled Fri 24-Mar-23 06:28 by mcpre

advertisement version: 2
VTP Management Domain: 'NSKNK'
Native VLAN: 1281
Duplex: full
Management address(es): 
  IP address: 10.20.60.254

-------------------------
Device ID: AP34B8.8315.8548
Entry address(es): 
  IP address: 10.20.128.117
  IPv6 address: FE80::CF45:B815:EEE4:9B4D  (link-local)
Platform: cisco C9124AXE-B,  Capabilities: Router Trans-Bridge 
Interface: TwoGigabitEthernet1/0/3,  Port ID (outgoing port): GigabitEthernet0
Holdtime : 126 sec

Version :
Cisco AP Software, ap1g6a-k9w8 Version: 17.11.0.155
Technical Support: http://www.cisco.com/techsupport
Copyright (c) 2014-2015 by Cisco Systems, Inc.

advertisement version: 2
Duplex: full
Power drawn: 39.501 Watts
Power request id: 35987, Power management id: 5
Power request levels are:39501 30000 15400 0 0 
Management address(es): 
  IP address: 10.20.128.117
Spare Pair PoE: Yes, Spare Pair Detection Required: No
Spare Pair PD Config: Enable, Spare Pair PSE Operational: Yes


Total cdp entries displayed : 11
'''

import re

device_infos = []
export_info = True
ip_addr = "10.20.128.72"
prompt = "TEST"
cdp_neighbors_result_ips = []
# Parse output, split string based on the Device keyword.
device_cdps = re.split("Device", NX_input)
# Loop through device strings.
for device in device_cdps:
    # Split lines.
    info = device.splitlines()

    # Create device info variables.
    device_info = {}
    hostname = "NULL"
    addr = "NULL"
    local_trunk_interface = "NULL"
    software_name = "NULL"
    version = "NULL"
    platform = "NULL"
    is_wireless_ap = False
    is_switch = False
    is_router = False
    is_phone = False
    is_camera = False
    parent_addr = "NULL"
    parent_host = "NULL"
    parent_trunk_interface = "NULL"
    # Loop through each line and find the device info.
    for line in info:
        # Find device IP address.
        if "IP address:" in line or "IPv4 Address" in line and addr == "NULL":
            # Replace keyword.
            addr = line.replace("IP address: ", "").strip()
            addr = addr.replace("IPv4 Address:", "").strip()
        # Attempt to determine if the device is a switch.
        if "Platform" in line and "Switch" in line:
            is_switch = True
            if "Router" in line:
                is_router = True
        # Find device type:
        if "AIR" in line or "Trans-Bridge" in line:
            is_wireless_ap = True
            is_switch = False
        # Check if export info is toggled on.
        if export_info and len(addr) > 0:
            # Find device hostname.
            if "ID:" in line and hostname == "NULL":
                # Replace keyword.
                line = line.replace("ID:", "")
                # Remove whitespace and store data.
                hostname = line.strip()

            # Find device software version info.
            if "Version :" not in line and "Version:" not in line and "Version" in line:
                # Split line up by commas.
                line = re.split(",", line)
                # Loop through and find software name and version.
                for i, section in enumerate(line):
                    # First line will be the software name.
                    if i == 0:
                        software_name = section
                    # Find version.
                    if "Version" in section:
                        # Remove keyword.
                        section = section.replace("Version", "")
                        # Strip whitespace and store.
                        version = section.strip()

            # Find platform.
            if "Platform" in line:
                # Remove keyword and other garbage after the comma
                line = line.replace("Platform:", "")
                line = line.split(",", 1)[0]
                # Remove whitespace and store.
                platform = line.strip()

            # Find the local trunk interface and parent interface.
            if "Interface:" in line:
                # Split line by comma.
                line = re.split(",", line)
                # Get and store the local and remote interface.
                remote_interface = line[0]
                local_interface = line[1]
                # Remove unessesary keyword arguments.
                remote_interface = remote_interface.replace("Interface:", "")
                local_interface = local_interface.replace("Port ID (outgoing port):", "")
                # Remove whitespace and store.
                local_trunk_interface = local_interface.strip()
                parent_trunk_interface = remote_interface.strip()

    # If both the software name and version were unable to be found assume device is not a switch, but a phone.
    if export_info:
        if software_name == "NULL" and version == "NULL":
            is_switch = False
            # If platform is null, then it's not a phone.
            if platform != "NULL" and platform != "Linux":
                is_phone = True

        # If it's not any of these, then assume it's a camera.
        if not any([is_router, is_switch, is_wireless_ap, is_phone]):
            is_camera = True

        # Append parent address to device.
        parent_addr = ip_addr
        parent_host = prompt

    # Add info to dictionary.
    device_info["hostname"] = hostname
    device_info["ip_addr"] = addr
    device_info["local_trunk_interface"] = local_trunk_interface
    device_info["software_name"] = software_name
    device_info["version"] = version
    device_info["platform"] = platform
    device_info["is_wireless_ap"] = is_wireless_ap
    device_info["is_switch"] = is_switch
    device_info["is_router"] = is_router
    device_info["is_phone"] = is_phone
    device_info["is_camera"] = is_camera
    device_info["parent_addr"] = parent_addr
    device_info["parent_host"] = parent_host
    device_info["parent_trunk_interface"] = parent_trunk_interface

    # Remove leading whitespace and append final ip to the cdp info list.
    if addr != "NULL" and is_switch:
        cdp_neighbors_result_ips.append(addr)

    # Append device to the device infos list.
    if export_info and device_info["hostname"] != "NULL" and device_info not in device_infos:
        device_infos.append(device_info)

print(device_infos)
print()
print(cdp_neighbors_result_ips)